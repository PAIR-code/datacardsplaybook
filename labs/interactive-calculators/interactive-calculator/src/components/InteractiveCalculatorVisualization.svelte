<!-- Copyright 2022 Google LLC. All Rights Reserved. Licensed under the Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) -->

<!-- 
    Reference: https://frappe.io/charts/docs 
    Alternative if Frappe Charts does not work: https://apexcharts.com/javascript-chart-demos/heatmap-charts/color-range/
    Frappe Heatmap Source Code: https://github.com/frappe/charts/blob/master/src/js/charts/Heatmap.js 
    Matrix heatmap data visualization - interactive calculator results
    Frappe Chart API: https://frappeframework.com/docs/v14/user/en/api/chart
-->
``````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````
<script src="https://cdn.jsdelivr.net/npm/frappe-charts@1.2.4/dist/frappe-charts.min.iife.js">
    import Chart from 'svelte-frappe-charts';
    import { Chart } from "frappe-charts";

    new Chart(); //ES6 module
    new frappe.ui.RealtimeChart(); //Browser
    
    import '$styles/global.scss';
    
    import ask from '$stores/ask.js';
    import inspect from '$stores/inspect.js';

    import { ShareButton } from 'lib/Button.svelte';

    //Chart exportable to SVG format
    let chartRef; 

    const onSave = () => chartRef.export();
    
    const onShare = () => chartRef.share(); 

    import save from 'src/assets/save.svg';
    import savewithword from 'src/assets/savewithword.svg';
    import share from 'src/assets/share.svg';

</script>

<script>
const data = {
    // labels: [] x axis
    // agents are the id
    // y axis are dimensions
    // datasets: []
    labels: [
        "Agent 1", 
        "Agent 2", 
        "Agent 3", 
        "Agent 4",
        "Agent 5",
    ],
        
    function updateData() {
        data = {

        };
    }

    // yMarkers and yRegions is where the following labels are marked on the data visualization
    yMarkers: [{ label: "Marker", value: 70, options: { labelPos: "left" } }],
    yRegions: [
      { label: "Region", start: -10, end: 50, options: { labelPos: "right" } }
    ] 
}


// legend is already included in the visualization
let chart = new frappe.ui.RealtimeChart("#chart", {  // or a DOM element,
                                            // new Chart() in case of ES6 module with above usage
    title: "Interactive Calculator Results",
    data: data,
    type: 'axis-mixed', // replacing with 'heatmap'
    height: 250,
    radius: 0, //change the radius of the heat squares, default 0
    discreteDomains: 0, //allow for continious distribution, rather than separate. default 1
    colors: ['#7cd6fd', '#743ee2'] // Use the colors given in variables.scss
    axisOptions: {
        xAxisMode: "tick";
        xIsSeries: true; //default is false
        //yAxisMode: "tick",
        yIsSeries: true; //default is false
    },
    heatmapOptions: {

    },
    tooltipOptions: {
        formatTooltipX: (d) => (d + "").toUpperCase(),
        formatTooltipY: (d) => d + " pts"
    }
})
    </script>

<!-- Starts listening to a specific socket event and updates the chart accordingly -->
frappe.ui.RealtimeChart.start_updating();

<!-- Where the chart goes -->
<div id="chart"></div>

<!-- Add share at the left bottom of the chart -->
<button on:click{onShare}>
    <img src="{share}" alt="Save" />
</button>

<!-- Add save at the right bottom of the chart -->
<button on:click={onSave}>
    <img src={savewithword} alt="save with word" />
  </button>

<!--Add prediction paragraph-->


<style lang="scss"> 

.chart { 
    border-collapse: collapse;
    position: absolute; 
    width: 100%; 
}
.agent-wrapper {
    position: sticky; 
    text-align: left; 
}

.dimension-wrapper {
    position: sticky; 
    text-align: top; 
}

</style>